name=cursor
version=2.3.41
release=1
summary="The AI Code Editor"
group="Development/Tools"
desc="$summary."
maintainer="Vladimir Romanov <rirusha@altlinux.org>"
architectures=("amd64" "arm64")
homepage="https://cursor.com/"
license=("MIT")

appstream_app_id='co.anysphere.cursor'

nonfree=1
nonfree_url="https://cursor.com/terms-of-service"

provides=()
conflicts=()

_commit=2ca326e0d1ce10956aea33d54c0e2d8c13c58a32

sources_amd64=(
	"https://downloads.cursor.com/production/${_commit}/linux/x64/rpm/x86_64/cursor-${version}.el8.x86_64.rpm?~name=${name}.rpm"
)

sources_arm64=(
	"https://downloads.cursor.com/production/${_commit}/linux/arm64/rpm/aarch64/cursor-${version}.el8.aarch64.rpm?~name=${name}.rpm"
)

checksums_amd64=(
	sha256:c5ae4fbe49c9cc332aac0660876ca9e234e97712f08a745fa0405f5147b3995f
)

checksums_arm64=(
	sha256:7a2c7c321f6f904ecb48221a96cd9f2e6de1d1099a42c5e0b545bb2a7a14da6b
)

deps=(
	libsecret
)

auto_req=1
auto_prov=1
auto_reqprov_method=dirty

disable_network=1

package() {
	cd $pkgdir
	rpm2cpio $srcdir/${name}.rpm | cpio -idmv
}

files() {
	files-find-binary ${name}
	files-find \
		"/usr/share/appdata/*" \
		"/usr/share/applications/*" \
		"/usr/share/bash-completion/completions/*" \
		"/usr/share/${name}/**/*" \
		"/usr/share/mime/packages/*" \
		"/usr/share/pixmaps/*" \
		"/usr/share/zsh/site-functions/*"
}
